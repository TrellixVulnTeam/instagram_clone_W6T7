{"ast":null,"code":"import _slicedToArray from\"/Users/sukritidawar/Desktop/webD/instagram-clone/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Button}from'@material-ui/core';import React,{useState}from'react';import{storage,db}from\"./firebase\";// import { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport firebase from'firebase/compat/app';import'firebase/compat/storage';import'firebase/compat/firestore';import'./ImageUpload.css';function ImageUpload(_ref){var username=_ref.username;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),image=_useState2[0],setImage=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),progress=_useState4[0],setProgress=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),caption=_useState6[0],setCaption=_useState6[1];var handleChange=function handleChange(e){if(e.target.files[0]){//get the first file user selected\nsetImage(e.target.files[0]);}};var handleUpload=function handleUpload(){// const storageRef = ref(storage);\n// // Points to 'images'\n// const imagesRef = ref(storageRef, 'images');\n// const fileName = image.name;\n// const spaceRef = ref(imagesRef, fileName);\n// // File path is 'images/space.jpg'\n// const path = spaceRef.fullPath;\n// const uploadTask = ref(storage, path).put(image);\nvar uploadTask=storage.ref(\"/images/\".concat(image.name)).put(image);uploadTask.on(\"state_changed\",function(snapshot){// progress function \nvar progress=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);//progress indicator from 0 to 100\nsetProgress(progress);},function(error){// Error function\nconsole.log(error);alert(error.message);},function(){// complete function\nstorage.ref('images').child(image.name).getDownloadURL().then(function(url){// post image in db\ndb.collection(\"posts\").add({timestamp:firebase.firestore.FieldValue.serverTimestamp(),//we want the timestamp so that we can put recent posts at top regardless of where we are in the world\ncaption:caption,imageUrl:url,username:username});setProgress(0);setCaption(\"\");setImage(null);});});};return/*#__PURE__*/React.createElement(\"div\",{className:\"imageUpload\"},/*#__PURE__*/React.createElement(\"progress\",{className:\"progressIndicator\",value:progress,max:\"100\"}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",placeholder:\"Enter a caption...\",onChange:function onChange(event){return setCaption(event.target.value);}}),/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:handleChange}),/*#__PURE__*/React.createElement(Button,{className:\"imageupload__button\",onClick:handleUpload},\"Upload\"));}export default ImageUpload;","map":{"version":3,"sources":["/Users/sukritidawar/Desktop/webD/instagram-clone/src/ImageUpload.js"],"names":["Button","React","useState","storage","db","firebase","ImageUpload","username","image","setImage","progress","setProgress","caption","setCaption","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"mappings":"uKAAA,OAASA,MAAT,KAAuB,mBAAvB,CACA,MAAOC,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,OAAT,CAAkBC,EAAlB,KAA4B,YAA5B,CACA;AACA,MAAOC,CAAAA,QAAP,KAAqB,qBAArB,CACA,MAAO,yBAAP,CACA,MAAO,2BAAP,CACA,MAAO,mBAAP,CAEA,QAASC,CAAAA,WAAT,MAAiC,IAAXC,CAAAA,QAAW,MAAXA,QAAW,CAC7B,cAA0BL,QAAQ,CAAC,IAAD,CAAlC,wCAAOM,KAAP,eAAcC,QAAd,eACA,eAAgCP,QAAQ,CAAC,CAAD,CAAxC,yCAAOQ,QAAP,eAAiBC,WAAjB,eACA,eAA8BT,QAAQ,CAAC,EAAD,CAAtC,yCAAOU,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAACC,CAAD,CAAO,CACxB,GAAGA,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAH,CAAsB,CAAE;AACpBR,QAAQ,CAACM,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAR,CACH,CACJ,CAJD,CAMA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,GAAMC,CAAAA,UAAU,CAAGhB,OAAO,CAACiB,GAAR,mBAAuBZ,KAAK,CAACa,IAA7B,GAAqCC,GAArC,CAAyCd,KAAzC,CAAnB,CAEAW,UAAU,CAACI,EAAX,CACI,eADJ,CAEI,SAACC,QAAD,CAAc,CACV;AACA,GAAMd,CAAAA,QAAQ,CAAGe,IAAI,CAACC,KAAL,CAAYF,QAAQ,CAACG,gBAAT,CAA4BH,QAAQ,CAACI,UAAtC,CAAoD,GAA/D,CAAjB,CAAsF;AACtFjB,WAAW,CAACD,QAAD,CAAX,CACH,CANL,CAOI,SAACmB,KAAD,CAAW,CACP;AACAC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACAG,KAAK,CAACH,KAAK,CAACI,OAAP,CAAL,CACH,CAXL,CAYI,UAAM,CACF;AACA9B,OAAO,CACNiB,GADD,CACK,QADL,EAECc,KAFD,CAEO1B,KAAK,CAACa,IAFb,EAGCc,cAHD,GAICC,IAJD,CAIM,SAAAC,GAAG,CAAI,CACT;AACAjC,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2B,CACvBC,SAAS,CAAEnC,QAAQ,CAACoC,SAAT,CAAmBC,UAAnB,CAA8BC,eAA9B,EADY,CACqC;AAC5D/B,OAAO,CAAEA,OAFc,CAGvBgC,QAAQ,CAAEP,GAHa,CAIvB9B,QAAQ,CAAEA,QAJa,CAA3B,EAMAI,WAAW,CAAC,CAAD,CAAX,CACAE,UAAU,CAAC,EAAD,CAAV,CACAJ,QAAQ,CAAC,IAAD,CAAR,CACH,CAfD,EAgBH,CA9BL,EAgCH,CA5CD,CA8CA,mBACI,2BAAK,SAAS,CAAC,aAAf,eAEI,gCAAU,SAAS,CAAC,mBAApB,CAAwC,KAAK,CAAEC,QAA/C,CAAyD,GAAG,CAAC,KAA7D,EAFJ,cAGI,6BAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAG,oBAAjC,CAAsD,QAAQ,CAAE,kBAAAmC,KAAK,QAAGhC,CAAAA,UAAU,CAACgC,KAAK,CAAC7B,MAAN,CAAa8B,KAAd,CAAb,EAArE,EAHJ,cAII,6BAAO,IAAI,CAAC,MAAZ,CAAmB,QAAQ,CAAEhC,YAA7B,EAJJ,cAKI,oBAAC,MAAD,EAAQ,SAAS,CAAC,qBAAlB,CAAwC,OAAO,CAAEI,YAAjD,WALJ,CADJ,CAWH,CAED,cAAeZ,CAAAA,WAAf","sourcesContent":["import { Button } from '@material-ui/core'\nimport React, { useState } from 'react'\nimport { storage, db } from \"./firebase\"\n// import { ref, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport firebase from 'firebase/compat/app';\nimport 'firebase/compat/storage';\nimport 'firebase/compat/firestore';\nimport './ImageUpload.css';\n\nfunction ImageUpload({username}) {\n    const [image, setImage] = useState(null);\n    const [progress, setProgress] = useState(0);\n    const [caption, setCaption] = useState('');\n\n    const handleChange = (e) => {\n        if(e.target.files[0]) { //get the first file user selected\n            setImage(e.target.files[0]);\n        }\n    }\n\n    const handleUpload = () => {\n        // const storageRef = ref(storage);\n        // // Points to 'images'\n        // const imagesRef = ref(storageRef, 'images');\n        // const fileName = image.name;\n        // const spaceRef = ref(imagesRef, fileName);\n        // // File path is 'images/space.jpg'\n        // const path = spaceRef.fullPath;\n        // const uploadTask = ref(storage, path).put(image);\n\n        const uploadTask = storage.ref(`/images/${image.name}`).put(image);\n\n        uploadTask.on(\n            \"state_changed\",\n            (snapshot) => {\n                // progress function \n                const progress = Math.round((snapshot.bytesTransferred / snapshot.totalBytes) * 100); //progress indicator from 0 to 100\n                setProgress(progress);\n            },\n            (error) => {\n                // Error function\n                console.log(error);\n                alert(error.message);\n            },\n            () => {\n                // complete function\n                storage\n                .ref('images')\n                .child(image.name)\n                .getDownloadURL()\n                .then(url => {\n                    // post image in db\n                    db.collection(\"posts\").add({\n                        timestamp: firebase.firestore.FieldValue.serverTimestamp(), //we want the timestamp so that we can put recent posts at top regardless of where we are in the world\n                        caption: caption,\n                        imageUrl: url,\n                        username: username\n                    })\n                    setProgress(0);\n                    setCaption(\"\");\n                    setImage(null);\n                });\n            }\n        );\n    };\n\n    return (\n        <div className=\"imageUpload\">\n            {/* Caption input + File Picker + Post button */}\n            <progress className=\"progressIndicator\" value={progress} max=\"100\" />\n            <input type=\"text\" placeholder = 'Enter a caption...' onChange={event=> setCaption(event.target.value)}/>\n            <input type=\"file\" onChange={handleChange} />\n            <Button className=\"imageupload__button\" onClick={handleUpload}> \n                Upload\n            </Button>\n        </div>\n    )\n}\n\nexport default ImageUpload\n"]},"metadata":{},"sourceType":"module"}